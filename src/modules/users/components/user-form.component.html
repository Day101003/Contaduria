<div class="side-panel" [class.open]="isOpen">
  <div class="side-panel-overlay" (click)="onClose()"></div>
  
  <div class="side-panel-content">
    <div class="side-panel-header">
      <h3>{{ isEditMode ? 'Editar Usuario' : 'Crear Nuevo Usuario' }}</h3>
      <button class="btn-close-panel" (click)="onClose()">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <form class="user-form" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label>Foto de Perfil</label>
        
        <div class="photo-upload-container">
          @if (user.profilePhoto) {
            <div class="photo-preview">
              <img [src]="user.profilePhoto" alt="Preview">
              <button type="button" class="btn-remove-photo" (click)="onRemovePhoto()" title="Eliminar foto">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <line x1="18" y1="6" x2="6" y2="18"></line>
                  <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
              </button>
            </div>
          } @else {
            <div class="photo-placeholder">
              <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
              <p>Sin foto</p>
            </div>
          }
        </div>
        
        <div class="file-input-wrapper">
          <input 
            type="file" 
            id="photoInput"
            class="file-input" 
            (change)="onFileSelected($event)"
            accept="image/*">
          <label for="photoInput" class="btn-upload">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="17 8 12 3 7 8"></polyline>
              <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
            Seleccionar imagen
          </label>
        </div>
      </div>

      <div class="form-group">
        <label>Nombre <span class="required">*</span></label>
        <input 
          type="text" 
          class="form-control" 
          [(ngModel)]="user.firstName"
          name="firstName"
          placeholder="Ingrese el nombre"
          required>
      </div>

      <div class="form-group">
        <label>Apellidos <span class="required">*</span></label>
        <input 
          type="text" 
          class="form-control" 
          [(ngModel)]="user.lastName"
          name="lastName"
          placeholder="Ingrese los apellidos"
          required>
      </div>

      <div class="form-group">
        <label>Cédula <span class="required">*</span></label>
        <input 
          type="text" 
          class="form-control" 
          [(ngModel)]="user.idCard"
          name="idCard"
          placeholder="001-1234567-8"
          required>
      </div>

      <div class="form-group">
        <label>Teléfono <span class="required">*</span></label>
        <input 
          type="text" 
          class="form-control" 
          [(ngModel)]="user.phone"
          name="phone"
          placeholder="809-555-1234"
          required>
      </div>

      <div class="form-group">
        <label>Correo Electrónico <span class="required">*</span></label>
        <input 
          type="email" 
          class="form-control" 
          [(ngModel)]="user.email"
          name="email"
          placeholder="usuario@ejemplo.com"
          required>
      </div>

      <div class="form-group">
        <label>Dirección <span class="required">*</span></label>
        <textarea 
          class="form-control" 
          [(ngModel)]="user.address"
          name="address"
          placeholder="Ingrese la dirección completa"
          rows="2"
          required></textarea>
      </div>

      <div class="form-group">
        <label>Rol <span class="required">*</span></label>
        <select 
          class="form-control" 
          [(ngModel)]="user.roleId"
          name="roleId"
          required>
          <option [value]="1">Administrador</option>
          <option [value]="2">Empleado</option>
          <option [value]="3">Usuario</option>
        </select>
      </div>

      <div class="form-actions">
        <button type="button" class="btn-cancel" (click)="onClose()">
          Cancelar
        </button>
        <button type="submit" class="btn-submit">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
          {{ isEditMode ? 'Guardar' : 'Crear Usuario' }}
        </button>
      </div>
    </form>
  </div>
</div>
